<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>🔧 Diagnostic OntoWave Multilingue</title>
    <style>
        body { font-family: monospace; margin: 20px; background: #f5f5f5; }
        .diagnostic { 
            background: white; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px; 
            border-left: 4px solid #007acc; 
        }
        .error { border-left-color: #d73a49; }
        .success { border-left-color: #28a745; }
        .warning { border-left-color: #ffc107; }
        button { 
            padding: 10px 15px; 
            margin: 5px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .test-btn { background: #007acc; color: white; }
        .fix-btn { background: #28a745; color: white; }
    </style>
</head>
<body>
    <h1>🔧 Diagnostic Système Multilingue OntoWave</h1>
    
    <div class="diagnostic">
        <h3>📋 Tests à effectuer :</h3>
        <button class="test-btn" onclick="testOntoWave()">🧪 Tester OntoWave</button>
        <button class="test-btn" onclick="testLanguageButtons()">🌐 Tester boutons langue</button>
        <button class="test-btn" onclick="openOntoWave()">🌊 Ouvrir OntoWave</button>
        <button class="fix-btn" onclick="fixLanguageButtons()">🔧 Corriger boutons</button>
    </div>

    <div id="results"></div>

    <script>
        let results = document.getElementById('results');

        function log(message, type = 'diagnostic') {
            const div = document.createElement('div');
            div.className = 'diagnostic ' + type;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        function testOntoWave() {
            log('🧪 Test OntoWave...');
            
            // Ouvrir OntoWave dans une nouvelle fenêtre
            const ontoWaveWindow = window.open('http://localhost:8080/', 'ontowave');
            
            setTimeout(() => {
                try {
                    // Tester les éléments
                    const hasLangFr = ontoWaveWindow.document.getElementById('lang-fr');
                    const hasLangEn = ontoWaveWindow.document.getElementById('lang-en');
                    const hasToggle = ontoWaveWindow.document.querySelector('.lang-toggle');
                    const hasOntoWave = ontoWaveWindow.window.OntoWave;
                    
                    log(hasLangFr ? '✅ lang-fr trouvé' : '❌ lang-fr manquant', hasLangFr ? 'success' : 'error');
                    log(hasLangEn ? '✅ lang-en trouvé' : '❌ lang-en manquant', hasLangEn ? 'success' : 'error');
                    log(hasToggle ? '✅ lang-toggle trouvé' : '❌ lang-toggle manquant', hasToggle ? 'success' : 'error');
                    log(hasOntoWave ? '✅ OntoWave chargé' : '❌ OntoWave manquant', hasOntoWave ? 'success' : 'error');
                    
                } catch (e) {
                    log('⚠️ Erreur Cross-Origin, ouvrez les dev tools sur http://localhost:8080/', 'warning');
                }
            }, 3000);
        }

        function testLanguageButtons() {
            log('🌐 Test des boutons de langue...');
            
            // Ouvrir OntoWave
            const ontoWaveWindow = window.open('http://localhost:8080/', 'ontowave');
            
            setTimeout(() => {
                try {
                    // Tester les fonctions
                    if (typeof ontoWaveWindow.toggleLang === 'function') {
                        log('✅ toggleLang trouvé', 'success');
                        
                        // Tester changement vers anglais
                        ontoWaveWindow.toggleLang('en');
                        log('🇬🇧 Test changement vers anglais', 'success');
                        
                        setTimeout(() => {
                            // Tester changement vers français
                            ontoWaveWindow.toggleLang('fr');
                            log('🇫🇷 Test changement vers français', 'success');
                        }, 1000);
                        
                    } else {
                        log('❌ toggleLang non trouvé', 'error');
                    }
                } catch (e) {
                    log('⚠️ Erreur: ' + e.message, 'warning');
                }
            }, 3000);
        }

        function openOntoWave() {
            log('🌊 Ouverture d\'OntoWave...');
            window.open('http://localhost:8080/', '_blank');
        }

        function fixLanguageButtons() {
            log('🔧 Instructions de correction:', 'warning');
            log('1. Ouvrez la console sur http://localhost:8080/', 'warning');
            log('2. Cherchez les erreurs JavaScript', 'warning');
            log('3. Vérifiez que toggleLang(\'fr\') et toggleLang(\'en\') fonctionnent', 'warning');
            log('4. Vérifiez que OntoWave.instance.updateInterfaceTexts() existe', 'warning');
        }

        // Test automatique au chargement
        window.addEventListener('load', () => {
            log('🚀 Diagnostic démarré');
            log('📍 Serveur OntoWave: http://localhost:8080/');
        });
    </script>
</body>
</html>
