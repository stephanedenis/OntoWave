<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple - D√©sactivation du d√©placement OntoWave</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            line-height: 1.6;
            padding-bottom: 100px;
        }
        .status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #007acc;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            font-family: monospace;
            z-index: 2000;
        }
        .test-controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #005a9e;
        }
    </style>
</head>
<body>
    <h1>üß™ Test Simple - D√©sactivation du D√©placement</h1>
    
    <div class="test-controls">
        <h3>Contr√¥les de test</h3>
        <button onclick="testDragState()">üîç V√©rifier √©tat de d√©placement</button>
        <button onclick="toggleMenu()">üìã Basculer le menu</button>
        <button onclick="openConfigPanel()">‚öôÔ∏è Ouvrir panneau config</button>
        <button onclick="closeConfigPanel()">‚ùå Fermer panneau config</button>
    </div>

    <div class="status" id="status">√âtat: Initialisation...</div>

    <h2>Instructions</h2>
    <ol>
        <li>Observez le menu flottant OntoWave en haut √† gauche</li>
        <li>Survolez-le : le curseur devrait √™tre "move" (main de d√©placement)</li>
        <li>Cliquez sur le bouton OntoWave pour √©tendre le menu</li>
        <li>Le curseur devrait changer en "default" (pas de d√©placement)</li>
        <li>Cliquez sur "Configuration" pour ouvrir le panneau</li>
        <li>Le d√©placement devrait rester d√©sactiv√©</li>
        <li>Fermez le panneau puis le menu pour r√©activer le d√©placement</li>
    </ol>

    <h2>Contenu de la page</h2>
    <p>Ceci est du contenu de test pour avoir une page avec du contenu.</p>
    
    <pre><code>function exemple() {
    console.log("Code d'exemple");
}</code></pre>

    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>

    <!-- Inclusion d'OntoWave -->
    <script src="dist/ontowave.js"></script>
    <script>
        // Variables globales pour les tests
        let ontowave;
        let statusDiv = document.getElementById('status');

        // Fonctions de test
        function updateStatus(message) {
            statusDiv.textContent = message;
            console.log('Status:', message);
        }

        function testDragState() {
            const menu = document.getElementById('ontowave-floating-menu');
            if (!menu) {
                updateStatus('‚ùå Menu non trouv√©');
                return;
            }

            const hasNoDrag = menu.classList.contains('no-drag');
            const hasExpanded = menu.classList.contains('expanded');
            const hasConfigPanel = !!document.querySelector('.ontowave-config-panel');
            const computedCursor = window.getComputedStyle(menu).cursor;

            updateStatus(`Drag: ${hasNoDrag ? 'D√âSACTIV√â' : 'ACTIV√â'} | √âtendu: ${hasExpanded} | Panel: ${hasConfigPanel} | Curseur: ${computedCursor}`);
        }

        function toggleMenu() {
            const menuIcon = document.getElementById('ontowave-menu-icon');
            if (menuIcon) {
                menuIcon.click();
                setTimeout(testDragState, 100);
            }
        }

        function openConfigPanel() {
            if (ontowave && ontowave.toggleConfigurationPanel) {
                ontowave.toggleConfigurationPanel();
                setTimeout(testDragState, 100);
            }
        }

        function closeConfigPanel() {
            const configPanel = document.querySelector('.ontowave-config-panel');
            if (configPanel) {
                configPanel.remove();
                if (typeof window.ontowaveUpdateDragState === 'function') {
                    window.ontowaveUpdateDragState();
                }
                setTimeout(testDragState, 100);
            }
        }

        // Initialiser OntoWave
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('üîÑ Initialisation OntoWave...');
            
            ontowave = new OntoWave({
                title: "Test Drag Disable",
                defaultPage: "index.md",
                baseUrl: "./",
                pages: ["index.md"]
            });

            // Simuler la pr√©sence d'un fichier index.md pour activer le menu flottant
            ontowave.loadPage = function() {
                console.log("Simulation: index.md pr√©sent - menu flottant activ√©");
                return Promise.resolve();
            };

            // Initialiser
            ontowave.init().then(() => {
                updateStatus('‚úÖ OntoWave initialis√©');
                setTimeout(testDragState, 500);
            }).catch(err => {
                updateStatus('‚ùå Erreur initialisation: ' + err.message);
            });
        });

        // Surveillance continue de l'√©tat
        setInterval(testDragState, 2000);
    </script>
</body>
</html>
