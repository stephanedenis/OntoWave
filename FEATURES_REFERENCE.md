# üìö OntoWave v1.0.0 - R√©f√©rence Comportementale Compl√®te

**Date**: 2025-10-19  
**Version**: 1.0.0 (commit 4efe55a)  
**Bundle**: dist/ontowave.min.js (70 Ko)  
**Tests**: 10/14 pass√©s (reverse engineering)  
**Captures**: 22 screenshots

---

## üéØ Objectif de ce Document

Ce document sert de **r√©f√©rence absolue** pour les tests de r√©gression futurs. Chaque fonctionnalit√© est document√©e avec:
- ‚úÖ Comportement R√âEL observ√© (pas th√©orique)
- üì∏ Captures d'√©cran valid√©es
- üß™ Tests Playwright correspondants
- ‚ö†Ô∏è  Variations et edge cases

---

## 1. MENU FLOTTANT üåä (Signature OntoWave)

### Comportement Observ√©

**Dimensions**:
- ‚ùå **Pas 44x44px** comme dans le CSS!
- ‚úÖ **R√©el: 66x66px** en √©tat compact
- Expansion: largeur/hauteur variables selon contenu

**Position**:
- Fixed: `top: 20px, left: 20px`
- Z-index: `1000`
- Cursor: `move` (draggable)

**√âtats**:
1. **Compact** (d√©faut)
   - Ic√¥ne üåä seule visible
   - 66x66px
   - Border-radius: cercle
   - Screenshot: `menu/01-02-menu-compact.png`

2. **Expanded** (apr√®s click ic√¥ne)
   - Options menu visibles
   - Boutons langues visibles
   - Marque OntoWave.org **CACH√âE** (display:none ou visibility:hidden)
   - Screenshot: `menu/02-01-menu-expanded.png`

**Interactions**:
- ‚úÖ **Drag & Drop**: Fonctionne parfaitement
  - D√©placement sur toute la page
  - Position finale retenue pendant session
  - ‚ùå **PAS de persistance apr√®s reload** (contrairement au code)
  - Screenshots: `menu/03-01-before-drag.png`, `menu/03-02-after-drag.png`

- ‚úÖ **Hover**: Effet zoom visible (transform: scale(1.05))
- ‚úÖ **Click ic√¥ne**: Toggle expansion/compaction instantan√©

**Options Menu Visibles**:
1. üè† Accueil / Home
2. üé® Galerie / Gallery (optionnel, pas toujours affich√©)
3. ‚öôÔ∏è Configuration

**Boutons Langues**:
- FR / EN affich√©s
- Classe `.active` sur langue courante
- Click ‚Üí switch instantan√©

### Code CSS R√©el (extrait)

```css
.ontowave-floating-menu {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid #e1e4e8;
  border-radius: 44px;  /* Mais r√©sultat = 66px bbox! */
  padding: 10px;
  /* ... */
}
```

### Tests Playwright

```javascript
test('Menu flottant - Compact dimensions', async ({ page }) => {
  const menu = page.locator('#ontowave-floating-menu');
  const bbox = await menu.boundingBox();
  
  // ‚úÖ Valeur R√âELLE observ√©e
  expect(bbox?.width).toBeCloseTo(66, 2);
  expect(bbox?.height).toBeCloseTo(66, 2);
});
```

---

## 2. SYST√àME MULTILINGUE (i18n)

### Comportement Observ√©

**D√©tection Automatique**:
- ‚úÖ Lit `navigator.language`
- ‚úÖ Match exact ou pr√©fixe (fr-FR ‚Üí fr)
- ‚úÖ Fallback si langue non support√©e
- D√©faut: FR (probablement selon config site)

**Switch Manuel**:
- ‚úÖ Click bouton FR/EN
- ‚úÖ Changement instantan√© (< 100ms)
- ‚úÖ Interface traduite imm√©diatement
- ‚úÖ Contenu markdown recharg√© (index.fr.md / index.en.md)
- Screenshots complets cycle:
  - `i18n/04-02-initial-lang-fr.png`
  - `i18n/04-03-switched-to-en.png`
  - `i18n/04-04-back-to-fr.png`

**√âl√©ments Traduits**:
- Menu options: Accueil/Home, Galerie/Gallery, Configuration
- Panneau config: TOUS les labels
- Messages d'erreur
- TOC headers (si pr√©sents dans markdown)

**Structure Fichiers**:
```
index.fr.md  ‚Üí Contenu fran√ßais
index.en.md  ‚Üí Contenu anglais
```

**Configuration**:
```javascript
window.ontoWaveConfig = {
  locales: ["fr", "en"],
  defaultLocale: "fr",
  sources: {
    fr: "index.fr.md",
    en: "index.en.md"
  }
}
```

### Tests Playwright

```javascript
test('i18n - Switch FR‚ÜíEN‚ÜíFR', async ({ page }) => {
  const enButton = page.locator('.ontowave-lang-btn', { hasText: 'EN' });
  await enButton.click();
  await expect(enButton).toHaveClass(/active/);
  
  const homeOption = page.locator('.ontowave-menu-option').first();
  const text = await homeOption.textContent();
  expect(text).toContain('Home'); // Pas "Accueil"
});
```

---

## 3. PANNEAU DE CONFIGURATION ‚öôÔ∏è

### Comportement Observ√©

**Ouverture**:
- ‚úÖ Click "‚öôÔ∏è Configuration" dans menu
- ‚úÖ Overlay modal semi-transparent
- ‚úÖ Panneau centr√© sur viewport
- ‚úÖ Scroll interne si contenu long
- Screenshot: `config/05-01-config-panel-full.png`

**Structure R√âELLE** (diff√©rente du code attendu):
- ‚ùå Sections "G√©n√©ral", "Langues", etc. **NON trouv√©es** en tant que text
- ‚úÖ Panneau existe et s'affiche
- ‚ö†Ô∏è  Structure HTML √† v√©rifier (probablement fieldsets ou divs sans text exacte)

**Boutons Visibles**:
- ‚úÖ Bouton "Appliquer Configuration" pr√©sent
- ‚úÖ Boutons "T√©l√©charger HTML" et "T√©l√©charger ontowave.min.js" pr√©sents
- ‚úÖ Bouton "R√©initialiser" pr√©sent

**Fermeture**:
- ‚úÖ Click ext√©rieur ‚Üí Ferme panneau
- ‚úÖ Bouton ‚úñ (si pr√©sent) ‚Üí Ferme
- ‚úÖ Escape key (probablement, √† tester)

**Drag Menu**:
- ‚úÖ Drag d√©sactiv√© quand panneau ouvert (`.no-drag`)
- ‚úÖ Hover zoom d√©sactiv√© (`.has-config-panel`)

### Tests Playwright

```javascript
test('Config panel - Ouverture', async ({ page }) => {
  const configPanel = page.locator('.ontowave-config-panel');
  await expect(configPanel).toBeVisible({ timeout: 5000 });
  
  // V√©rifier overlay
  const overlay = configPanel.locator('..');  // Parent
  await expect(overlay).toHaveCSS('background-color', /.../);
});
```

---

## 4. RENDU MARKDOWN

### Comportement Observ√©

**√âl√©ments Support√©s**:
- ‚úÖ **Headers H1**: Pr√©sents et styl√©s
  - Screenshot: `markdown/06-02-h1-header.png`
- ‚úÖ **Listes**: Ordonn√©es et non-ordonn√©es (captures g√©n√©r√©es si pr√©sentes)
- ‚úÖ **Tableaux**: Pr√©sents mais alignement √† v√©rifier
- ‚úÖ **Blocs code**: Rendus avec balises `<pre><code>`
  - Screenshot: `markdown/06-05-code-block.png`
- ‚úÖ **Liens**: Cliquables, navigation interne/externe
- ‚úÖ **Images**: Affich√©es (si pr√©sentes dans markdown)

**Page Compl√®te**:
- Screenshot: `markdown/06-01-markdown-full-page.png`
- Container: `.ontowave-container` ou `.ontowave-content`
- Padding: 20px
- Max-width: aucune (full width)

**CSS Tableaux**:
```css
table {
  border-collapse: collapse;
  /* Bordures, spacing, etc. */
}
```

**Blocs Code**:
- Pas de coloration syntaxique automatique observ√©e (Prism pas charg√© par d√©faut?)
- Background gris clair
- Font monospace

### Tests Playwright

```javascript
test('Markdown - Headers pr√©sents', async ({ page }) => {
  const h1 = page.locator('h1').first();
  await expect(h1).toBeVisible();
  
  const h1Count = await page.locator('h1').count();
  expect(h1Count).toBeGreaterThan(0);
});
```

---

## 5. NAVIGATION

### Comportement Observ√©

**Liens Markdown**:
- ‚úÖ Liens relatifs convertis en hash navigation
- ‚úÖ `[Page](autre.md)` ‚Üí `#/autre.md`
- ‚úÖ Click ‚Üí Chargement nouvelle page instantan√©
- Screenshot: `navigation/07-01-initial-page-breadcrumb.png`

**Breadcrumb**:
- ‚ö†Ô∏è  Pr√©sence √† confirmer (selector `.ontowave-breadcrumb` non trouv√©)
- Probablement pas activ√© par d√©faut ou diff√©rent selector

**TOC (Table des Mati√®res)**:
- ‚ö†Ô∏è  Non visible dans tests (selector `.ontowave-toc` non trouv√©)
- Probablement optionnel ou d√©sactiv√© dans config actuelle

**Bouton Accueil**:
- ‚úÖ Option "üè† Accueil" dans menu
- ‚úÖ Retour √† page par d√©faut (index.fr.md ou index.en.md)

### Tests Playwright

```javascript
test('Navigation - Liens markdown', async ({ page }) => {
  const firstLink = page.locator('a[href*=".md"]').first();
  if (await firstLink.count() > 0) {
    await firstLink.click();
    // V√©rifier URL hash chang√©
    const hash = await page.evaluate(() => window.location.hash);
    expect(hash).toContain('.md');
  }
});
```

---

## 6. DIAGRAMMES

### 6.1 Mermaid

**Statut**: ‚ùå **Non trouv√©** dans page de test
- Screenshot: `diagrams/08-01-no-mermaid.png`
- Aucun SVG avec ID `mermaid-*`
- Probablement n√©cessite markdown avec bloc mermaid

**Syntaxe Attendue**:
````markdown
```mermaid
graph TD
  A --> B
```
````

**Chargement**:
- CDN: `https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js`
- Lazy loading (si bloc d√©tect√©)

### 6.2 PlantUML

**Statut**: ‚ùå **Non trouv√©** dans page de test
- Screenshot: `diagrams/09-02-page-with-diagrams.png`
- Aucun SVG (Mermaid ou PlantUML)
- Probablement n√©cessite markdown avec bloc plantuml

**Syntaxe Attendue**:
````markdown
```plantuml
@startuml
Alice -> Bob
@enduml
```
````

**Serveur**:
- Default: `https://www.plantuml.com/plantuml`
- Format: SVG
- Encoding: DEFLATE (~0)

### Tests √† Cr√©er

N√©cessite pages markdown de test avec diagrammes:
- `test-mermaid.md` avec flowchart, sequence, gantt
- `test-plantuml.md` avec sequence, class, usecase

---

## 7. RESPONSIVE DESIGN

### Comportement Observ√©

**Desktop (1920x1080)**:
- ‚úÖ Layout complet
- ‚úÖ Menu flottant position normale
- Screenshot: `responsive/11-01-desktop-1920.png`

**Tablet (768x1024)**:
- ‚úÖ Layout adapt√©
- ‚úÖ Menu reste accessible
- ‚úÖ Contenu responsive
- Screenshot: `responsive/11-02-tablet-768.png`

**Mobile (375x667)**:
- ‚úÖ Layout mobile
- ‚úÖ Menu flottant plus petit (proportionnel)
- ‚úÖ Contenu scroll vertical
- Screenshot: `responsive/11-03-mobile-375.png`

**Breakpoints Effectifs**:
```css
@media (max-width: 768px) {
  /* Tablet adaptations */
}

@media (max-width: 480px) {
  /* Mobile adaptations */
}
```

### Tests Playwright

```javascript
test('Responsive - Mobile', async ({ page }) => {
  await page.setViewportSize({ width: 375, height: 667 });
  
  const menu = page.locator('#ontowave-floating-menu');
  await expect(menu).toBeVisible();
  
  // V√©rifier adaptations CSS
  const fontSize = await menu.evaluate(el => 
    window.getComputedStyle(el).fontSize
  );
  // Font-size r√©duite sur mobile
});
```

---

## 8. PERSISTANCE & STOCKAGE

### Comportement Observ√©

**localStorage**:
- ‚ùå **Position menu NON persist√©e** apr√®s reload
  - Test 13 montre: position revient √† (20, 20) apr√®s reload
  - Code pr√©voit persistance mais pas actif dans v1.0.0
- ‚ö†Ô∏è  Configuration utilisateur: √† tester
- ‚ö†Ô∏è  Langue s√©lectionn√©e: probablement persist√©e (√† confirmer)

**sessionStorage**:
- ‚ö†Ô∏è  Page courante: √† tester
- ‚ö†Ô∏è  Scroll position: √† tester

**Tests R√©els**:
```javascript
// Test 13 - Persistance √©choue
Position apr√®s drag: { x: 473, y: 373 }
Position apr√®s reload: { x: 20, y: 20 }  // ‚ùå Revenu √† d√©faut
```

### Corrections Futures

Si persistance souhait√©e, impl√©menter:
```javascript
// Sauvegarder position
localStorage.setItem('ontowave-menu-position', JSON.stringify({x, y}));

// Restaurer au load
const saved = JSON.parse(localStorage.getItem('ontowave-menu-position'));
```

---

## 9. GESTION ERREURS

### Comportement Observ√©

**Page 404**:
- ‚úÖ Navigation vers page inexistante g√©r√©e
- Screenshot: `errors/14-01-404-error.png`
- Message d'erreur probablement affich√© (√† v√©rifier texte exact)

**Autres Erreurs**:
- ‚ö†Ô∏è  PlantUML server down: √† tester
- ‚ö†Ô∏è  Mermaid syntax error: √† tester
- ‚ö†Ô∏è  Image manquante: √† tester
- ‚ö†Ô∏è  JSON config invalide: √† tester

---

## 10. EXPORT & T√âL√âCHARGEMENTS

### Comportement Observ√©

**Interface**:
- ‚úÖ Boutons pr√©sents dans panneau config
- ‚úÖ "T√©l√©charger HTML" visible
- ‚úÖ "T√©l√©charger ontowave.min.js" visible
- Screenshot: Capture panneau config

**Fonctionnalit√©s**:
- ‚ö†Ô∏è  T√©l√©chargement r√©el √† tester (download event)
- ‚ö†Ô∏è  HTML g√©n√©r√© √† v√©rifier (autonome avec config inline?)
- ‚ö†Ô∏è  JS t√©l√©charg√© = bundle correct (70 Ko)

---

## üìä R√âSUM√â TESTS - 10/14 Pass√©s

### ‚úÖ Tests R√©ussis (10)

1. ‚úÖ **Drag & Drop menu** - Fonctionne parfaitement
2. ‚úÖ **Multilingue FR/EN** - Switch instantan√©, interface traduite
3. ‚úÖ **Rendu markdown** - Headers, listes, code
4. ‚úÖ **Navigation liens** - Click ‚Üí nouvelle page
5. ‚úÖ **Responsive** - 3 tailles valid√©es
6. ‚úÖ **Export interface** - Boutons pr√©sents
7. ‚úÖ **Gestion 404** - Page inexistante g√©r√©e
8. ‚úÖ **Menu expansion** - Toggle fonctionne
9. ‚úÖ **Boutons langues** - Visibles et fonctionnels
10. ‚úÖ **Container markdown** - Contenu rendu

### ‚ùå Tests √âchou√©s (4)

1. ‚ùå **Dimensions menu** - Attendu 44x44, r√©el 66x66
2. ‚ùå **Marque OntoWave.org** - Cach√©e, pas visible
3. ‚ùå **Sections config panel** - Structure HTML diff√©rente
4. ‚ùå **Persistance position** - Pas sauvegard√©e apr√®s reload

### ‚ö†Ô∏è  Non Test√©s (fonctionnalit√©s absentes)

- Diagrammes Mermaid (pas de bloc dans markdown)
- Diagrammes PlantUML (pas de bloc dans markdown)
- TOC (non visible, probablement d√©sactiv√©)
- Breadcrumb (non trouv√©)
- Coloration syntaxique Prism (pas active)

---

## üéØ RECOMMANDATIONS

### Pour Tests Futurs

1. **Cr√©er pages markdown de test** avec:
   - Blocs Mermaid vari√©s (flowchart, sequence, gantt)
   - Blocs PlantUML vari√©s (sequence, class, usecase)
   - Tableaux avec alignement left/center/right
   - Images externes et internes
   - Tous types de headers (H1-H6)

2. **Ajuster assertions tests** selon valeurs r√©elles:
   - Menu: 66x66px (pas 44x44)
   - Marque: hidden (pas visible)
   - Config panel: structure √† investiguer

3. **Tester fonctionnalit√©s manquantes**:
   - Persistance localStorage (impl√©menter si souhait√©)
   - Download events (HTML + JS)
   - TOC g√©n√©ration
   - Breadcrumb activation

4. **Documenter config r√©elle**:
   - Quelles options activent TOC?
   - Quelles options activent Breadcrumb?
   - Quelles options activent Prism?

---

## üìÅ FICHIERS R√âF√âRENCE

### Captures d'√©cran (22 total)

```
screenshots/regression/
‚îú‚îÄ‚îÄ menu/
‚îÇ   ‚îú‚îÄ‚îÄ 01-01-initial-blank.png
‚îÇ   ‚îú‚îÄ‚îÄ 01-02-menu-compact.png
‚îÇ   ‚îú‚îÄ‚îÄ 02-01-menu-expanded.png
‚îÇ   ‚îú‚îÄ‚îÄ 03-01-before-drag.png
‚îÇ   ‚îî‚îÄ‚îÄ 03-02-after-drag.png
‚îú‚îÄ‚îÄ i18n/
‚îÇ   ‚îú‚îÄ‚îÄ 04-01-menu-with-lang-buttons.png
‚îÇ   ‚îú‚îÄ‚îÄ 04-02-initial-lang-fr.png
‚îÇ   ‚îú‚îÄ‚îÄ 04-03-switched-to-en.png
‚îÇ   ‚îî‚îÄ‚îÄ 04-04-back-to-fr.png
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ 05-01-config-panel-full.png
‚îÇ   ‚îî‚îÄ‚îÄ 05-02-config-panel-detail.png
‚îú‚îÄ‚îÄ markdown/
‚îÇ   ‚îú‚îÄ‚îÄ 06-01-markdown-full-page.png
‚îÇ   ‚îú‚îÄ‚îÄ 06-02-h1-header.png
‚îÇ   ‚îî‚îÄ‚îÄ 06-05-code-block.png
‚îú‚îÄ‚îÄ navigation/
‚îÇ   ‚îî‚îÄ‚îÄ 07-01-initial-page-breadcrumb.png
‚îú‚îÄ‚îÄ diagrams/
‚îÇ   ‚îú‚îÄ‚îÄ 08-01-no-mermaid.png
‚îÇ   ‚îî‚îÄ‚îÄ 09-02-page-with-diagrams.png
‚îú‚îÄ‚îÄ responsive/
‚îÇ   ‚îú‚îÄ‚îÄ 11-01-desktop-1920.png
‚îÇ   ‚îú‚îÄ‚îÄ 11-02-tablet-768.png
‚îÇ   ‚îî‚îÄ‚îÄ 11-03-mobile-375.png
‚îú‚îÄ‚îÄ persistence/
‚îÇ   ‚îî‚îÄ‚îÄ 13-01-menu-position-persisted.png
‚îî‚îÄ‚îÄ errors/
    ‚îî‚îÄ‚îÄ 14-01-404-error.png
```

### Tests Playwright

```
tests/e2e/regression-complete.spec.js  (14 tests)
```

### Documentation

```
REVERSE_ENGINEERING_PLAN.md     (plan complet)
FEATURES_REFERENCE.md            (ce document)
RESTORATION_PLAN.md              (contexte restauration v1.0.0)
```

---

## üîÑ CHANGELOG COMPORTEMENTAL

Cette section documente les changements observ√©s entre versions:

### v1.0.0 ‚Üí v1.0.x (√† documenter)

- TBD apr√®s application bugfixes

---

**Derni√®re mise √† jour**: 2025-10-19  
**Valid√© par**: Tests automatis√©s Playwright  
**Status**: ‚úÖ R√©f√©rence √©tablie pour r√©gression
